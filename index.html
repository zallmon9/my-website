<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>แบบประเมินการสอน</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<div class="container mt-5 mb-5">

<h2 class="text-center mb-4">แบบประเมินการสอน</h2>

<div class="mb-4">
    <label class="fw-bold">อาจารย์ผู้สอน</label>
    <select class="form-select" id="teacher">
        <option value="">-- เลือกอาจารย์ --</option>
        <option>อ.สมชาย</option>
        <option>อ.สมหญิง</option>
    </select>
</div>

<table class="table table-bordered text-center align-middle">
    <thead class="table-success">
        <tr>
            <th style="width:60px">ข้อ</th>
            <th>คำถาม</th>
            <th style="width:300px">คะแนน</th>
        </tr>
    </thead>
    <tbody id="questionTable"></tbody>
</table>

<div class="mb-4">
    <label class="fw-bold">ข้อเสนอแนะเพิ่มเติม</label>
    <textarea id="comment" class="form-control" rows="3"></textarea>
</div>

<button class="btn-submit w-100" onclick="submitEval()">ส่งแบบประเมิน</button>

<div id="resultBox" class="mt-5 d-none">
    <h4 class="text-center mb-3">ผลการประเมิน</h4>
    <canvas id="resultChart" height="200"></canvas>
</div>

</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

const table = document.getElementById("questionTable");

const questions = [
    "อาจารย์เตรียมการสอนเป็นอย่างดี",
    "อธิบายเนื้อหาเข้าใจง่าย",
    "เปิดโอกาสให้นักศึกษาซักถาม",
    "ใช้สื่อการสอนเหมาะสม",
    "สร้างบรรยากาศการเรียนที่ดี"
];

questions.forEach((q,i)=>{
    table.innerHTML += `
    <tr>
        <td>${i+1}</td>
        <td class="text-start">${q}</td>
        <td>
            ${[1,2,3,4,5].map(n=>`
                <input type="radio" name="q${i}" value="${n}" class="rating-radio" id="q${i}_${n}">
                <label for="q${i}_${n}" class="rating-label">${n}</label>
            `).join("")}
        </td>
    </tr>`;
});

window.submitEval = function(){
    let scores=[];
    for(let i=0;i<questions.length;i++){
        let c=document.querySelector(`input[name="q${i}"]:checked`);
        if(!c){ alert("กรุณาประเมินให้ครบทุกข้อ"); return; }
        scores.push(+c.value);
    }

    document.getElementById("resultBox").classList.remove("d-none");

    new Chart(document.getElementById("resultChart"),{
        type:'bar',
        data:{
            labels:questions.map((_,i)=>`ข้อ ${i+1}`),
            datasets:[{
                data:scores,
                backgroundColor:"#4caf50"
            }]
        },
        options:{
            scales:{ y:{ beginAtZero:true, max:5 } },
            plugins:{ legend:{ display:false } }
        }
    });
}

});
</script>

</body>
</html>
