<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>แบบประเมินการสอน</title>
<style>
table { width:100%; border-collapse:collapse; }
th,td { border:1px solid #ccc; padding:8px; text-align:center; }
.rating input { margin:0 3px; }
button { padding:10px 20px; margin-top:15px; }
</style>
</head>
<body>

<h2 align="center">แบบประเมินการสอน</h2>

<select id="teacher">
  <option value="">-- เลือกอาจารย์ --</option>
  <option>อาจารย์ ก</option>
  <option>อาจารย์ ข</option>
  <option>อาจารย์ ค</option>
</select>

<table>
<tr>
<th>ข้อ</th>
<th>คำถาม</th>
<th>คะแนน (1–5)</th>
</tr>

<tbody id="questionTable"></tbody>
</table>

<br>
<textarea id="comment" placeholder="ข้อเสนอแนะเพิ่มเติม" style="width:100%;height:80px;"></textarea>

<br><br>
<button onclick="submitEval()">ส่งแบบประเมิน</button>

<p id="msg"></p>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxEs_RdNYWr36g92xl71ECQCS-vIc3hNPmUuhOnNVya/dev";

const questions = [
    "อาจารย์เตรียมการสอนเป็นอย่างดี",
    "อธิบายเนื้อหาเข้าใจง่าย",
    "เปิดโอกาสให้นักศึกษาซักถาม",
    "ใช้สื่อการสอนเหมาะสม",
    "สร้างบรรยากาศการเรียนที่ดี",
    "ตรงต่อเวลา",
    "มีความเป็นธรรมในการให้คะแนน",
    "เชื่อมโยงเนื้อหากับการใช้งานจริง",
    "ให้คำแนะนำที่เป็นประโยชน์",
    "เอาใจใส่นักศึกษา"
];

const table = document.getElementById("AKfycbxEs_RdNYWr36g92xl71ECQCS-vIc3hNPmUuhOnNVya");

questions.forEach((q,i)=>{
  let radios = "";
  for(let n=1;n<=5;n++){
    radios += `<label>
      <input type="radio" name="q${i}" value="${n}"> ${n}
    </label>`;
  }

  table.innerHTML += `
  <tr>
    <td>${i+1}</td>
    <td align="left">${q}</td>
    <td class="rating">${radios}</td>
  </tr>`;
});

function submitEval(){
  const teacher = document.getElementById("teacher").value;
  if(!teacher){ alert("กรุณาเลือกอาจารย์"); return; }

  let scores = [];
  for(let i=0;i<10;i++){
    const checked = document.querySelector(`input[name="q${i}"]:checked`);
    if(!checked){ alert("กรุณาประเมินให้ครบทุกข้อ"); return; }
    scores.push(Number(checked.value));
  }

  const data = {
    teacher: teacher,
    scores: scores,
    comment: document.getElementById("comment").value
  };

  fetch(SCRIPT_URL,{
    method:"POST",
    body: JSON.stringify(data)
  })
  .then(res=>res.json())
  .then(()=>{
    document.getElementById("msg").innerHTML =
      "✅ ส่งแบบประเมินเรียบร้อยแล้ว";
  });
}
</script>

</body>
</html>
